---
title: "**Univariate Descriptive Statistics**"
author: "Bachelor in Computer Science and Engineering"
date: "2020/21"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Introduction

The objective of this document is to present the most used techniques of Descriptive Statistics to resume the information of a dataset of one variable. The data we are going to analyze in this handbook are stored in the file \texttt{AlumnosIndustriales.xlsx}. These data correspond to 95 students of Industrial Engineering, to whom it was asked about some variables such as height, weight, number of siblings, and another seven variables. In this way we are going to use a simple dataset that will help us to learn the basic descriptive function of \textsf{R}.

First we read and view the data file. The figure shows the first five observations of this datafile. Note that the line \texttt{View (IndustrialStudents)} appears as a comment, to execute it, simply delete the symbol \texttt{\#}.

```{r}
library(readxl)
AlumnosIndustriales <- read_excel("AlumnosIndustriales.xlsx")
View(AlumnosIndustriales)
```

![](AlumnosIndustriales.jpg)

# 2. Description of categorical variables

The variable \texttt{residencia} corresponds to the home location of the students. This variable is categorical. The set of values it can have is

* Madrid Sur (1)
* Madrid Centro (2)
* Madrid-otros (3)
* Fuera de Madrid (4)

To describe this variable we first obtain a frequency table.

```{r}
ABStable <- table(AlumnosIndustriales$residencia)
lbls <- c("Madrid Sur", "Madrid Centro", "Madrid-otros", "Fuera de Madrid")
row.names(ABStable) <- lbls
ABStable
RELtable <- prop.table(ABStable)
RELtable
```

where we can see that the biggest group of students are the ones that come from Madrid Sur, made of 46 students which account for the 48.4% of the sample. 

In order to get a bar chart or a pie chart, we use the following instructions:

```{r}
barplot(ABStable)
```
```{r}
pie(ABStable)
```

# 3. Description of quantitative variables

## 3.1 Graphical analysis of discrete variable with only few values

In the case of quantitative discrete variables assuming only few values, the graphic analysis is the same as the one we saw for categorical variables. We can now plot a bar chart. The frequency table would be similar to the one generated by using the analysis of categorical data.

For example, the variable \texttt{hermanos} gives the number of siblings that each student has.

```{r}
ABStable <- table(AlumnosIndustriales$hermanos)
ABStable
RELtable <- prop.table(ABStable)
RELtable
```

```{r}
barplot(ABStable)
```

From the picture we can see that the families more frequent (among those who have children studying Industrial Engineering at UC3M) are the ones with 2 or 3 children (1 or 2 siblings).

## 3.2 Graphical analysis of quantitative variables

The graphical analysis of generaL quantitative variables can be done using the functions \texttt{hist} and \texttt{boxplot}.

The variable \texttt{altura} contains the heights of the students. Here, we plot its histogram and its boxplot. 

```{r}
par(mfrow=c(1,2))
hist(AlumnosIndustriales$altura, xlab = "Height", main = "Histogram")
boxplot(AlumnosIndustriales$altura, ylab = "Height", main = "Boxplot")
```

The boxplot show that the height distribution is asymmetric. The central box shows a skewness to the left even if the tail are not very long. This effect is visible in the histogram as well. Also, we can see two modes suggest that the sample is not homogeneous. Probably this is due to the joint presence of males’ and females’ heights.

The variable \texttt{sexo} contains the gender of the students (1 = male, 0 = female). We can use this variable to select the heights of mans or of woman and in this way to check if these two groups have the corresponding height data concentrated around the two modes.

```{r}
par(mfrow=c(1,2))
hist(AlumnosIndustriales$altura[AlumnosIndustriales$sexo == 1], xlab = "Height", 
     main = "Histogram for males")
hist(AlumnosIndustriales$altura[AlumnosIndustriales$sexo == 0], xlab = "Height", 
     main = "Histogram for females")
```

We see that displaying only the males’ heights, the distribution looks more symmetric, unimodal, and with mode in the interval [175, 180], with a high concentration around it. Repeating the same for females we get that its distribution does not have a unimodal bell shape like the one of the males. Maybe this can be due to the fact that we have less data (only 32 individuals) or maybe because they are heterogeneous by themselves. 

## Frequency table

The frequency table gives us the same information contained in the corresponding histogram, but it let us to see the numerical values of the frequencies in each interval. To obtain the frequency table we can use the following code:

```{r}
Altura <- AlumnosIndustriales$altura
range(Altura)
breaks = seq(155, 195, by=5)
breaks
Altura.cut = cut(Altura, breaks, right=TRUE)
Altura.table = table(Altura.cut)
Altura.table
prop.table(Altura.table)
```

These tables show that the modal interval are around the values (midpoint), 167.5 and 177.5, and that the interval with highest frequency, with midpoint 177.5, contains more than 30% of the students.

# 3.4 Numerical summary measures of quantitative variables

To compute the summary measures of the variable \texttt{altura} we can use the function \texttt{summary}: 

```{r}
summary(Altura)
```

It gives position summary measures such mean, median, first and third quartiles, the minimum and the maximum. 

Another summary statistics can be obtained using function \texttt{descr} from package \texttt{summarytools}:

```{r message=FALSE, warning=FALSE}
suppressWarnings(library(summarytools))
descr(Altura)
```

It includes the previous position statistics and some dispersion and shape measures such as the standard deviation, the coefficient of variation, the MAD, the skewness and the kurtosis coefficients.

It is now necessary to clarify some things about these summary measures:

* The variance (as a consecuence, the standard deviation) that is used is indeed the sample variance that is computed using the following formula $s^2 = \frac{\sum_{i=1}^n (x_i - \bar{x})^2 }{n-1}$ instead of the variance formula $\widehat{\sigma}^2 = \frac{\sum_{i=1}^n (x_i - \bar{x})^2 }{n}$. The convenience of dividing by $n-1$ instead of $n$ is not immediate, and their theoretical justification will be seen on more advanced topics.

* The kurtosis coefficient computed is what is known as ‘excess kurtosis’, defined as $\kappa = \frac{\sum_{i=1}^n (x_i - \bar{x})^4}{n s^4} - 3$. Therefore for a bell shaped variable the kurtosis is equal to 0.

In the following it is shown a comparison between males and females by mean of some characteristic measures:

```{r message=FALSE, warning=FALSE}
suppressWarnings(library(summarytools))
descr(Altura[AlumnosIndustriales$sexo==1])
descr(Altura[AlumnosIndustriales$sexo==0])
```


We can see now that the men of this sample are in average taller than the women. The average height of men is 179 cm  while for the women it is 165 cm. In both genders the mean is almost equal to the median; this is clearly visible looking at the symmetry of the boxplot (see section 4) and the low absolute value of the skewness. This concentration around the median value is visible also when looking at the interquartile range. 50% of the men (women) located in the central positions have a height that differs from the median value by less than 3 cm. 

## 3.5 Percentiles

To obtain the percentiles, we use the function \texttt{quantile}

```{r}
quantile(Altura, probs = seq(0, 1, 0.1))
```

So, we can conclude that 20% of the students is less than 167 cm tall and 80% of them is less than  181 cm. The argument \texttt{probs} can have any value in the interval $[0,1]$. 

# 4 Simultaneous description of more than one variable

In many cases we are interested in comparing several variables, or compare the values of a variable divided into two or more groups of individuals as in the case of height by gender. In such cases it is more interesting to produce graphs and statistical summaries together in the same window to make this comparison, instead of performing the univariate analysis of each variable separately. For example, we would want to generate the boxplots of each variable on the same graph.

## 4.1 Multiple boxplots

Our goal is to create a graph that has the boxplot diagrams of several variables in it or the same variable divided in more than one subgroup. This graph will allow a better comparison of these variables. 

### 4.1.1 One quantitative variable by subgroups

We are interested in analyzing how the distribution of the values of one variable is when the dataset is subdivided into subgroups according to some criterion. For examplem we want to study the heights of a group of students according to their gender. The variable \texttt{sexo} just takes values 1 and 0. These values are needed only to distinguish the members of each group, so the number they assume is irrelevant. It could be -1 and 1, or even characters.

```{r}
boxplot(AlumnosIndustriales$altura ~ AlumnosIndustriales$sexo, xlab = "Gender", 
        ylab = "Height", names = c("Females", "Males"))
```

It may be seen that men are generally taller than women. Simultaneously displaying the two box-whisker plots we can interpret that approximately only 25% of the women have higher heights comparable to 25% of the shorter mens. Also, some outliers at the men's boxplot are visible. 

### 4.1.2 Several quantitative variables

If we have several variables of the same magnitude or different magnitudes, we can also do multiple boxplot of these variables in one graph. As an example we will use the data file \texttt{Rotura.xlsx}. This file contains the breakdown tension or ultimate tensile strength (that is the strengh at the moment that the rupture occurs) of a set of identical parts in order to test the resistance of the material. The file contains ten variables, LAB1 to LAB10, where each sample of breakage tensions is obtained in ten different laboratories. In each laboratory 100 different pieces are broken and the corresponding pressure values are recorded. We are going to show the boxplots of these ten variables:

```{r}
library(readxl)
Roturas <- read_excel("Roturas.xlsx")
View(Roturas)
```

![](Roturas.jpg)

```{r}
boxplot(Roturas[,1:10])
```

It is seen that the results of the 10 laboratories are similar. From the whiskers of the third quartile and from the outliers it can be seen that in general, the distributions are positive skewed.

## 4.2 Two overlapped histograms

If we want to compare two histograms, it is useful to put them in the same graph. There are many ways to produce overlappeed histograms but here we show how to do it using the base \textsf{R} graphics. We will use the example of heights by gender:

```{r}
# notice that plot = FALSE
histMales <- hist(Altura[AlumnosIndustriales$sexo == 1], breaks = seq(155,195,2.5),
                  plot = FALSE)
histFemales <- hist(Altura[AlumnosIndustriales$sexo == 0], breaks = seq(155,195,2.5),
                    plot = FALSE)
# calculate the range of the graph
xlim <- range(histMales$breaks,histFemales$breaks)
ylim <- range(0,histMales$density,histFemales$density)
# plot the first histogram
plot(histMales,xlim = xlim, ylim = ylim, col = rgb(1,0,0,0.4), xlab = 'Height',
     freq = FALSE, ## relative, not absolute frequency
     main = 'Distribution of heights by gender')
## plot the second histogram on top of this
opar <- par(new = FALSE)
plot(histFemales,xlim = xlim, ylim = ylim,
     xaxt = 'n', yaxt = 'n', ## don't add axes
     col = rgb(0,0,1,0.4), add = TRUE,
     freq = FALSE) ## relative, not absolute frequency
## add a legend in the corner
legend('topleft',c('Males','Females'), fill = rgb(1:0,0,0:1,0.4), bty = 'n', border = NA)
par(opar)
```

Another posibility is to obtain mirrored histogram:

```{r}
par(mfrow=c(2,1))
 
#Make the plot
par(mar=c(0,5,3,3))
hist(Altura[AlumnosIndustriales$sexo == 1], main="" , xlim=c(155,195), 
     ylab="Frequency", xlab="", ylim=c(0,25) , xaxt="n", las=1 , 
     col="blue", breaks=10)
par(mar=c(5,5,0,3))
hist(Altura[AlumnosIndustriales$sexo == 0], main="" , xlim=c(155,195), 
     ylab="Frequency", xlab="Height", ylim=c(25,0), las=1,
     col="red"  , breaks=10)
legend('bottomright',c('Males','Females'), fill = c("blue", "red"), bty = 'n', border = NA)
```

The \texttt{ggplot2} package, created by Hadley Wickham, offers a powerful graphics language for creating elegant and complex plots and it is very popular at the \textsf{R} community. Mastering the \texttt{ggplot2} language can be challenging. There is a helper function called \texttt{qplot} that can hide much of this complexity when creating standard graphs such as histograms. Moreover, we can combine histogram and boxplot in the same graph:

```{r}
suppressWarnings(library(ggplot2))
AlumnosIndustriales$gender <- "Male"
AlumnosIndustriales$gender[AlumnosIndustriales$sexo == 0] <- "Female"
qplot(altura, data=AlumnosIndustriales, geom=c("histogram", "boxplot"), fill=gender, 
      alpha=I(.5), main="Distribution of heights by gender", 
      xlab="Height", ylab="Frequency")
```

## 4.3 Numerical summary measures of several variables-

In general, we start our data analysis by looking at the graphs. In a second moment we look for measures that can summarize in a quantitative way the features of most interest. 

We will use the data.frame \texttt{AlumnosIndustriales}. It should be notice that variables \texttt{sexo}, \texttt{locomocion} and \texttt{residencia} are coded as numeric and variable \texttt{gender} is character, so we can change their class in order to obtain valid summary statistics.

```{r}
AlumnosIndustriales$sexo <- as.factor(AlumnosIndustriales$sexo)
AlumnosIndustriales$residencia <- as.factor(AlumnosIndustriales$residencia)
AlumnosIndustriales$locomocion <- as.factor(AlumnosIndustriales$locomocion)
AlumnosIndustriales$gender <- as.factor(AlumnosIndustriales$gender)
summary(AlumnosIndustriales)
```

If you are only interested on quantitative variables, you can use function \texttt{descr} from package \texttt{summaryTools}:

```{r}
descr(AlumnosIndustriales)
```


